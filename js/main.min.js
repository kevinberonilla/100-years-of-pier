var page=$("html, body"),body=$("body"),isMobile=!1,isDev=!1,mobileUserAgentString=/Mobile|iP(hone|od|ad)|Android|BlackBerry|IEMobile|Kindle|NetFront|Silk-Accelerated|(hpw|web)OS|Fennec|Minimo|Opera M(obi|ini)|Blazer|Dolfin|Dolphin|Skyfire|Zune/i;mobileUserAgentString.test(navigator.userAgent)&&(isMobile=!0),$(document).ready(function(){function e(){body.prepend('<div id="preload"></div>');var e=$("#preload");$("[data-background-image]").each(function(){var a=$(this).data("background-image");e.append('<img src="'+a+'" alt="">')}),$('[style*="background-image"]').each(function(){var a=$(this).attr("style").replace("background-image: url(","").replace(")","").replace(";","");e.append('<img src="'+a+'" alt="">')}),isMobile||$("[data-music]").each(function(){var a=$(this);e.append('<audio id="music-for-'+a.index("section")+'" loop preload="true"><source src="'+a.data("music")+'" type="audio/mpeg"></audio>')})}function a(e,a,i){e.stop().animate({volume:a},1500,i)}function i(e){M.each(function(){var e=$(this);a(e,0,function(){e[0].pause()})}),e[0].play(),a(e,T)}function t(e){if(e.hasClass("end")){var a=e.prevAll(".has-intro").first().index("section"),t=$("#music-for-"+a);i(t)}else if(e.hasClass("has-intro")){var o=e.index("section"),s=$("#music-for-"+o);i(s)}else e.is("#home")&&i($("#music-for-0"))}function o(){var e=$(window).height();z.css("height",e+"px")}function s(){A.each(function(){var e=page.width(),a=page.height(),i=$(this).width(),t=$(this).height(),o=e/2-i/2+"px",s=a/2-t/2+"px";$(this).css({left:o,top:s})})}function n(){A.each(function(){$(this)[0].play()})}function l(){function e(){s++;var e=parseInt(s/t*100);o.css("width",e+"%"),n.text(e)}var a=$("img"),i=$("audio, video"),t=a.length+i.length,o=$("#loading-bar"),s=0,n=$("#loading-percentage .number");a.load(e),i.each(function(){$(this)[0].oncanplaythrough=e}),$(window).load(function(){var e=$("#home-video"),a=$("#music-for-0"),i=$(".scroll-message");o.css("width","100%"),n.text("100"),a[0].play(),setTimeout(function(){body.addClass("loaded"),e.addClass("show")},250),setTimeout(function(){body.trigger("pageready.np")},isDev?0:2e3),setTimeout(function(){i.addClass("show")},3e3)})}function r(){var e=$(window).width();q.each(function(){var a=$(this),i=a.closest(".container").width(),t=e-i;a.css({left:"-"+t/2+"px",right:"-"+t/2+"px"})})}function d(){var e=$(window).height(),a=e/j;D.css("height",a+"px")}function c(){body.addClass("nav-open").addClass("disable-scroll"),D.each(function(){var e=this,a=$(e).index();setTimeout(function(){$(e).addClass("show")},75*(a+1))}),setTimeout(function(){I.addClass("blur")},250)}function h(){body.removeClass("nav-open").removeClass("disable-scroll"),D.removeClass("show"),setTimeout(function(){I.removeClass("blur")},150)}function u(e,a){for(var i,t=0;t<a.length;t++){var o=a.eq(t);if(e.is(o)){i=t;break}}return i}function f(e){var a,i,t=$(e).hasClass("has-intro"),o=$('section[id*="chapter"]'),s=$("#home");if(t)a=u(e,o),i=a/o.length*100+"%";else if(e.is(s))i=0;else{a=u(e,O);var n=O.eq(a).prevAll(".has-intro").first(),l=(n.attr("id"),u(n,O)),r=u(n,o),d=r/o.length*100,a=u(e,O),c=(a-l)/U[r]/o.length*100;i=d+c+"%"}L.css("height",i)}function v(e){var a=$(".animate-in",e);a.each(function(){function e(){0==i||a.is("[data-delay]")||a.attr("data-delay",i+"00")}var a=$(this),i=a.index();$.when(e()).done(function(){var e=a.data("delay")||0;setTimeout(function(){a.addClass("reveal")},e)})})}function m(){"undefined"==typeof K?K=Z.parallax():K.parallax("enable")}function w(){"undefined"!=typeof K&&K.parallax("disable")}function p(){if(N=$("section.active"),N.is("#home")?(ee.addClass("show"),ie.removeClass("show"),J.removeClass("show")):(ee.removeClass("show"),J.addClass("show")),N.hasClass("has-overlay")?(G.addClass("show"),W.addClass("show"),ie.removeClass("show"),m()):(G.removeClass("show"),W.removeClass("show"),w()),N.hasClass("has-underlay")){var e=N.data("underlay-background");_.css("background-image","url("+e+")").addClass("show"),ie.removeClass("show")}else _.removeClass("show");if(N.hasClass("has-background-image")){var a=N.data("background-image");Q.css("background-image","url("+a+")").addClass("show")}else Q.removeClass("show");N.is("#home")||N.hasClass("has-overlay")||N.hasClass("has-underlay")?ae.removeClass("show"):(ie.addClass("show"),ae.addClass("show")),f(N),t(N)}function g(){v(N)}function y(){te.each(function(){var e=$(this).find(".timeline-content").offset().top,a=$(this).closest("section").offset().top,i=e-a+se+ne,t=$(".timeline-border",this);t.css("top",i+"px")}),oe.each(function(){var e=$(this).find(".timeline-body").last().height(),a=$(this).find(".timeline-content").innerHeight(),i=$(this).closest("section").height()>560?$(this).closest("section").height():560,t=$(this).find(".timeline-gallery").outerHeight(!0),o=$(this).find(".timeline-slider").outerHeight(!0),s=(i-a)/2+e+t+o-se,n=$(".timeline-border",this);n.css("bottom",s+"px")})}function b(){me.each(function(){var e=$(this),a=$(".quote-image",e),i=e.width(),t=e.height(),o=a.width(),s=a.height(),n=i-o,l=t-s,r=a.data("offset-x")||0,d=a.data("offset-y")||0;a.css({left:n/2+r+"px",top:l/2+d+"px"})})}function C(){var e=$("section.active .quote-body .animate-in");e.removeClass("reveal")}function x(){var e=$("section.active .quote-body .animate-in");e.addClass("reveal")}$.when(e()).done(l);var k=$("#audio-icon"),M=($("audio"),$('audio[id*="music-for"]')),T=($('audio[id*="sound-for"]'),1);k.click(function(){$(this).hasClass("fa-volume-up")?($(this).removeClass("fa-volume-up").addClass("fa-volume-off").addClass("adjust-p-r-6"),adjustAudioVolume(0)):($(this).removeClass("fa-volume-off").addClass("fa-volume-up").removeClass("adjust-p-r-6"),adjustAudioVolume(1))});var z=$(".full-parent-height   ");o(),$(window).resize(o);var A=$(".video-background");isMobile&&A.find("source").remove(),$(window).resize(s),$(window).load(s),!isMobile&&A.length>0&&$(window).load(n);var q=$(".quote-background-image");r(),$(window).resize($.debounce(500,r));var D=$("nav > ul > li"),S=$("a",D),j=D.length,B=$("#open-nav-button"),F=$("#close-nav-button"),I=$("#underlay, #clouds, .video-background"),R=$(".main");S.click(function(e){e.preventDefault();var a=$(this).attr("href"),i=$(a).index()+1;h(),R.moveTo(i)}),d(),$(window).resize(d),B.click(c),F.click(h);for(var H=$("#sub-nav > ul > li"),P=$("a",H),L=$("#position-indicator"),O=$("section:not(#home)"),U=[],V=1,X=0;X<O.length;X++){var Y=O.eq(X);Y.hasClass("end")?(Y.is(":last-child")&&V--,U.push(V),V=1):V++}P.click(function(e){e.preventDefault();var a=$(this).attr("href"),i=$(a).index()+1;R.moveTo(i)});var E=$(".logo-container.horizontal > a");E.click(function(){R.moveTo(1)});var K,N,Z=$("#clouds"),_=$("#underlay"),G=$("#overlay"),J=$("#sub-nav"),Q=$("#background-image"),W=$("#clouds"),ee=$("#home-video"),ae=$("#background-video"),ie=($("#home #title"),$(".logo-container.horizontal"));body.on("pageready.np",function(){$("#main").onepage_scroll({sectionContainer:"section",easing:"ease",animationTime:isDev?100:1e3,keyboard:!0,direction:"vertical",pagination:!1,loop:!1,beforeMove:p,afterMove:g})});var te=$(".timeline-entry.start"),oe=$(".timeline-entry.end"),se=30,ne=20;$(window).load(y),$(window).resize($.debounce(750,y));var le=$(".gallery.type-a"),re=matchMedia("only screen and (max-width: 1024px)").matches?80:0,de=le.closest(".container").width();le.each(function(){function e(){i.unbind().removeClass("active").removeAttr("style"),re=matchMedia("only screen and (max-width: 1024px)").matches?80:0,de=le.closest(".container").width(),a.Cloud9Carousel({autoPlay:0,bringToFront:!0,smooth:!0,transforms:!0,speed:250,itemClass:"gallery-entry",yRadius:-25,xRadius:(de-re)/(o-1)}),t.addClass("active"),i.click(function(){i.removeClass("active"),$(this).addClass("active")})}var a=$(this),i=$(".gallery-entry",a),t=i.first(),o=i.length;a.Cloud9Carousel({autoPlay:0,bringToFront:!0,smooth:!0,transforms:!0,speed:250,itemClass:"gallery-entry",yRadius:-25,xRadius:(de-re)/(o-1)}),t.addClass("active"),i.click(function(){i.removeClass("active"),$(this).addClass("active")}),$(window).resize($.debounce(500,e))});var ce=$(".gallery.type-b");if(ce.each(function(){function e(){o=matchMedia("only screen and (max-width: 1024px)").matches?60:140,n=$(a).closest(".container").width(),l=matchMedia("only screen and (max-width: 1024px)").matches?80:0,r=n-(t-1)*(o+s)-s-l,$("> li.active",a).css("width",r+"px")}var a=this,i=$("> li",a),t=i.length,o=matchMedia("only screen and (max-width: 1024px)").matches?60:140,s=10,n=$(a).closest(".container").width(),l=matchMedia("only screen and (max-width: 1024px)").matches?80:0,r=n-(t-1)*(o+s)-s-l;i.click(function(){i.removeClass("active").css("width",""),$(this).addClass("active").css("width",r+"px")}),$(window).resize($.debounce(500,e)),i.first().click()}),!isMobile){var he=$(".gallery"),ue=0,fe=0,ve=!1;he.on("mousemove",function(e){ve===!0&&($(this).scrollTop(parseInt($(this).scrollTop()+(ue-e.offsetY))),$(this).scrollLeft(parseInt($(this).scrollLeft()+(fe-e.offsetX))))}),he.on("mousedown",function(e){ve=!0,ue=e.offsetY,fe=e.offsetX,e.preventDefault()}),he.on("mouseup",function(){ve=!1}),he.on("mouseout",function(){ve=!1})}var $e=$(".slider");$("section.has-slider");$(window).load(function(){$.when($e.twentytwenty()).done(function(){setTimeout(function(){$e.each(function(){var e=this,a=$(e).data("before-text")||"Before",i=$(e).data("after-text")||"After",t=$(".twentytwenty-handle",e),o=$(".twentytwenty-before-label, .twentytwenty-after-label",e);o.remove(),t.append('<div class="twentytwenty-before-label">'+a+"</div>",'<div class="twentytwenty-after-label">'+i+"</div>")}),$(this).trigger("resize")},1e3)})});var me=$(".quote-image-container");me.hover(C,x),$(window).resize($.debounce(500,b)),$(window).load(b)});
var page=$("html, body"),body=$("body"),isMobile=!1,isDev=!1,mobileUserAgentString=/Mobile|iP(hone|od|ad)|Android|BlackBerry|IEMobile|Kindle|NetFront|Silk-Accelerated|(hpw|web)OS|Fennec|Minimo|Opera M(obi|ini)|Blazer|Dolfin|Dolphin|Skyfire|Zune/i;mobileUserAgentString.test(navigator.userAgent)&&(isMobile=!0),$(document).ready(function(){function e(){body.append('<div id="preload"></div>');var e=$("#preload");$("img").each(function(){var a=$(this).attr("src");e.append('<img src="'+a+'" alt="">')}),$("[data-background-image]").each(function(){var a=$(this).data("background-image");e.append('<img src="'+a+'" alt="">')}),$('[style*="background-image"]').each(function(){var a=$(this).attr("style").replace("background-image: url(","").replace(")","").replace(";","");e.append('<img src="'+a+'" alt="">')}),isMobile||($("[data-music]").each(function(){var a=$(this);e.append('<audio id="music-for-'+a.index("section")+'" loop preload="true"><source src="'+a.data("music")+'" type="audio/mpeg"></audio>')}),$("[data-sound]").each(function(){var a=$(this);e.append('<audio id="sound-for-'+a.index("section")+'" preload="true"><source src="'+a.data("sound")+'" type="audio/mpeg"></audio>')}))}function a(){var e=window.innerHeight;z.css("height",e+"px")}function i(e,a,i){e.stop().animate({volume:a},1e3,"linear",i)}function t(e){S.each(function(){var e=$(this);i(e,0,function(){e[0].pause()})}),e[0].play(),i(e,H)}function n(e){if(e.hasClass("end")){var a=e.prevAll(".has-intro").first().index("section"),i=$("#music-for-"+a);t(i)}else if(e.hasClass("has-intro")){var n=e.index("section"),o=$("#music-for-"+n);t(o)}else e.is("#home")&&t($("#music-for-0"))}function o(e){var a=e.index("section"),t=$("#sound-for-"+a),n=D.not(t);i(D,0,function(){n[0].pause(),n[0].currentTime=0}),t.length>0&&(t[0].play(),i(t,H))}function s(){var e=window.innerHeight;B.css("height",e+"px")}function r(){E.each(function(){var e=page.width(),a=page.height(),i=$(this).width(),t=$(this).height(),n=e/2-i/2+"px",o=a/2-t/2+"px";$(this).css({left:n,top:o})})}function d(){E.each(function(){$(this)[0].play()})}function l(){function e(){if(!body.hasClass("loaded")){o++;var e=parseInt(o/t*100);n.css("width",e+"%"),s.text(e),o===t&&body.trigger("load.np")}}var a=$("#preload img"),i=$("#preload audio, .video-background[data-src][data-formats]"),t=isMobile?a.length:a.length+i.length,n=$("#loading-bar"),o=0,s=$("#loading-percentage .number");a.each(function(){$(this).load(e)}),i.each(function(){var a=$(this)[0];a.readyState>3?e():a.oncanplay=e}),page.one("load.np",function(){var e=$("#home-video"),a=$("#music-for-0"),i=$(".scroll-message");setTimeout(function(){body.addClass("loaded"),e.addClass("show"),isMobile||a[0].play()},250),setTimeout(function(){body.trigger("start.np")},isDev?0:1e3),setTimeout(function(){i.addClass("show")},3e3)})}function c(){var e=$(window).width();F.each(function(){var a=$(this),i=a.closest(".container").width(),t=e-i;a.css({left:"-"+t/2+"px",right:"-"+t/2+"px"})})}function h(){var e=window.innerWidth,a=window.innerHeight,i=matchMedia("only screen and (max-width: 480px)").matches?a-e/I-5:a,t=i/I;P.css("height",t+"px")}function u(){body.addClass("nav-open").addClass("disable-scroll"),P.each(function(){var e=this,a=$(e).index();setTimeout(function(){$(e).addClass("show")},75*(a+1))}),setTimeout(function(){O.addClass("blur")},250)}function f(){body.removeClass("nav-open").removeClass("disable-scroll"),P.removeClass("show"),setTimeout(function(){O.removeClass("blur")},150)}function v(e,a){for(var i,t=0;t<a.length;t++){var n=a.eq(t);if(e.is(n)){i=t;break}}return i}function m(e){var a,i,t,n=$(e).hasClass("has-intro"),o=$('section[id*="chapter"]'),s=$("#home");if(X.removeClass("active"),n)a=v(e,o),i=$('[href="#'+o.eq(a).attr("id")+'"]',X).parent(),t=a/o.length*100+"%";else if(e.is(s))t=0;else{a=v(e,W);var r=W.eq(a).prevAll(".has-intro").first(),d=(r.attr("id"),v(r,W)),l=v(r,o),c=l/o.length*100,a=v(e,W),h=(a-d)/Z[l]/o.length*100;i=$('[href="#'+W.eq(d).attr("id")+'"]',X).parent(),t=c+h+"%"}N.css({width:"",height:""}),matchMedia("only screen and (max-width: 480px)").matches?N.css("width",t):N.css("height",t),i&&i.addClass("active")}function p(e){var a=$(".animate-in",e);a.each(function(){function e(){0==i||a.is("[data-delay]")||a.attr("data-delay",i+"00")}var a=$(this),i=a.index();$.when(e()).done(function(){var e=a.data("delay")||0;setTimeout(function(){a.addClass("reveal")},e)})})}function w(e,a){switch(a){case"clouds":"undefined"==typeof Y?Y=e.parallax():Y.parallax("enable");break;case"fireworks":"undefined"==typeof ee?ee=e.parallax():ee.parallax("enable")}}function g(e){switch(e){case"clouds":"undefined"!=typeof Y&&Y.parallax("disable");break;case"fireworks":"undefined"!=typeof ee&&ee.parallax("disable")}}function b(){var e=$("> li",te);te.addClass("show"),e.each(function(){var e=$("img",this),a=$(this).index();setTimeout(function(){e.addClass("show")},100*a)})}function y(){if(ae=$("section.active"),ae.is("#home")?(de.addClass("show"),ce.removeClass("show"),se.removeClass("show"),te.addClass("show"),isMobile||w(te,"fireworks")):(de.removeClass("show"),se.addClass("show"),ce.addClass("show"),te.removeClass("show"),isMobile||g("fireworks")),ae.hasClass("has-overlay")?(oe.addClass("show"),ie.addClass("show"),isMobile||w(ie,"clouds")):(oe.removeClass("show"),ie.removeClass("show"),isMobile||g("clouds")),ae.hasClass("has-underlay")){var e=ae.data("underlay-background");ne.css("background-image","url("+e+")").addClass("show")}else ne.removeClass("show");if(ae.hasClass("has-background-underlay")){var a=ae.data("background-image");re.css("background-image","url("+a+")").addClass("show")}else re.removeClass("show");ae.is("#home")||ae.hasClass("has-overlay")||ae.hasClass("has-underlay")?le.removeClass("show"):le.addClass("show"),m(ae),isMobile||(n(ae),o(ae))}function C(){p(ae)}function x(){setTimeout(function(){var e;if(matchMedia("only screen and (max-width: 480px)").matches){var a=$(window).width();e=a/I-20}else e=20;he.each(function(){var a=$(this).find(".timeline-content").offset().top,i=$(this).closest("section").offset().top,t=a-i+fe+e,n=$(".timeline-border",this);n.css("top",t+"px")}),ue.each(function(){var e=$(this).find(".timeline-body").last().height(),a=$(this).find(".timeline-content").innerHeight(),i=$(this).closest("section").height()>560?$(this).closest("section").height():560,t=$(this).find(".timeline-gallery").outerHeight(!0),n=$(this).find(".timeline-slider").outerHeight(!0),o=(i-a)/2+e+t+n-fe,s=$(".timeline-border",this);s.css("bottom",o+"px")})},1e3)}function k(){Ce.each(function(){var e=$(this),a=$(".quote-image",e),i=e.width(),t=e.height(),n=a.width(),o=a.height(),s=i-n,r=t-o,d=a.data("offset-x")||0,l=a.data("offset-y")||0;a.css({left:s/2+d+"px",top:r/2+l+"px"})})}function M(){var e=$("section.active .quote-body .animate-in");e.removeClass("reveal")}function T(){var e=$("section.active .quote-body .animate-in");e.addClass("reveal")}if($.when(e()).done(l),isMobile){var z=$("#wrapper");a(),$(window).resize($.debounce(500,a))}var q=$("#audio-icon"),A=$("audio"),S=$('audio[id*="music-for"]'),D=$('audio[id*="sound-for"]'),H=1;isMobile?q.unbind():q.click(function(){$(this).hasClass("fa-volume-up")?($(this).removeClass("fa-volume-up").addClass("fa-volume-off").addClass("adjust-p-r-6"),H=0):($(this).removeClass("fa-volume-off").addClass("fa-volume-up").removeClass("adjust-p-r-6"),H=1),A.each(function(){$(this).stop(!1,!0),$(this)[0].volume=H})}).parent().addClass("show");var B=$(".full-parent-height");s(),$(window).resize(s);var E=$(".video-background");isMobile||E.each(function(){var e=$(this),a=e.data("src"),i="undefined"!=typeof e.data("formats")?e.data("formats").replace(" ","").split(","):"";if(a&&i.length>0)for(var t=0;t<i.length;t++)e.append('<source src="'+a+"."+i[t]+'">')}),$(window).resize(r),$(window).load(r),!isMobile&&E.length>0&&$(window).load(d);var F=$(".quote-background-image");c(),$(window).resize($.debounce(500,c));var P=$("nav > ul > li"),R=$("a",P),I=P.length,j=$("#open-nav-button"),L=$("#close-nav-button"),O=$("#underlay, #clouds, #fireworks, .video-background"),U=$(".main");R.click(function(e){e.preventDefault();var a=$(this).attr("href"),i=$(a).index()+1;f(),U.moveTo(i)}),h(),$(window).resize($.debounce(750,h)),j.click(u),L.click(f);for(var X=$("#sub-nav > ul > li"),K=$("a",X),N=$("#position-indicator"),W=$("section:not(#home)"),Z=[],_=1,G=0;G<W.length;G++){var J=W.eq(G);J.hasClass("end")?(Z.push(_),_=1):_++}K.click(function(e){e.preventDefault();var a=$(this).attr("href"),i=$(a).index()+1;U.moveTo(i)}),$(window).resize($.debounce(750,function(){m($("section.active"))}));var Q=$(".logo-container.horizontal > a");Q.click(function(){U.moveTo(1)});var V=$("#main section *");V.on("webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend webkitTransitionStart otransitionstart oTransitionStart msTransitionStart transitionstart",function(e){e.stopPropagation()});var Y,ee,ae,ie=$("#clouds"),te=$("#fireworks"),ne=$("#underlay"),oe=$("#overlay"),se=$("#sub-nav"),re=$("#background-image"),de=$("#home-video"),le=$("#background-video"),ce=($("#home #title"),$(".logo-container.horizontal"));body.one("start.np",function(){$("#main").onepage_scroll({sectionContainer:"section",easing:"ease",animationTime:isDev?100:1e3,keyboard:!0,direction:"vertical",pagination:!1,loop:!1,beforeMove:y,afterMove:C}),isMobile||w(te,"fireworks"),b()});var he=$(".timeline-entry.start"),ue=$(".timeline-entry.end"),fe=30;$(window).load(x),$(window).resize($.debounce(1e3,x));var $e=$(".gallery.type-a"),ve=matchMedia("only screen and (max-width: 1024px)").matches?240:80,me=$e.closest(".container").width();$e.each(function(){function e(){i.unbind().removeClass("active").removeAttr("style"),ve=matchMedia("only screen and (max-width: 1024px)").matches?240:80,me=$e.closest(".container").width(),a.Cloud9Carousel({autoPlay:0,bringToFront:!0,smooth:!0,transforms:!0,speed:250,itemClass:"gallery-entry",yRadius:-25,xRadius:(me-ve)/(n-1)}),t.addClass("active"),i.click(function(){i.removeClass("active"),$(this).addClass("active")})}var a=$(this),i=$(".gallery-entry",a),t=i.first(),n=i.length;a.Cloud9Carousel({autoPlay:0,bringToFront:!0,smooth:!0,transforms:!0,speed:250,itemClass:"gallery-entry",yRadius:-25,xRadius:(me-ve)/(n-1)}),t.addClass("active"),i.click(function(){i.removeClass("active"),$(this).addClass("active")}),$(window).resize($.debounce(500,e))});var pe=$(".gallery.type-b");pe.each(function(){function e(){n=matchMedia("only screen and (max-width: 1024px)").matches?60:120,s=$(a).closest(".container").width(),r=matchMedia("only screen and (max-width: 1024px)").matches?240:80,d=s-(t-1)*(n+o)-o-r,$("> li.active",a).css("width",d+"px")}var a=this,i=$("> li",a),t=i.length,n=matchMedia("only screen and (max-width: 1024px)").matches?60:120,o=10,s=$(a).closest(".container").width(),r=matchMedia("only screen and (max-width: 1024px)").matches?240:80,d=s-(t-1)*(n+o)-o-r;i.click(function(){i.removeClass("active").css("width",""),$(this).addClass("active").css("width",d+"px")}),$(window).resize($.debounce(500,e)),i.first().click()});var we=$(".gallery");if(isMobile);else{var ge=0,be=!1;we.on("mousedown",function(e){ge=e.offsetX,be=!0}),we.on("mousemove",function(e){be===!0&&$(this).scrollLeft(parseInt($(this).scrollLeft()+(ge-e.offsetX)))}),we.on("mouseup mouseout",function(){be=!1})}var ye=$(".slider");$("section.has-slider");$(window).load(function(){$.when(ye.twentytwenty()).done(function(){setTimeout(function(){ye.each(function(){var e=this,a=$(e).data("before-text")||"Before",i=$(e).data("after-text")||"After",t=$(".twentytwenty-handle",e),n=$(".twentytwenty-before-label, .twentytwenty-after-label",e);n.remove(),t.append('<div class="twentytwenty-before-label">'+a+"</div>",'<div class="twentytwenty-after-label">'+i+"</div>")}),$(this).trigger("resize")},1e3)})});var Ce=$(".quote-image-container");isMobile||Ce.hover(M,T),$(window).resize($.debounce(500,k)),$(window).load(k)});
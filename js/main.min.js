var page=$("html, body"),body=$("body"),isMobile=!1,isDev=!1,mobileUserAgentString=/Mobile|iP(hone|od|ad)|Android|BlackBerry|IEMobile|Kindle|NetFront|Silk-Accelerated|(hpw|web)OS|Fennec|Minimo|Opera M(obi|ini)|Blazer|Dolfin|Dolphin|Skyfire|Zune/i;mobileUserAgentString.test(navigator.userAgent)&&(isMobile=!0,$(document).on("touchmove",function(e){e.preventDefault()})),$(document).ready(function(){function e(){body.append('<div id="preload"></div>');var e=$("#preload");$("img").each(function(){var a=$(this).attr("src");e.append('<img src="'+a+'" alt="">')}),$("[data-background-image]").each(function(){var a=$(this).data("background-image");e.append('<img src="'+a+'" alt="">')}),$('[style*="background-image"]').each(function(){var a=$(this).attr("style").replace("background-image: url(","").replace(")","").replace(";","");e.append('<img src="'+a+'" alt="">')}),isMobile||($("[data-music]").each(function(){var a=$(this);e.append('<audio id="music-for-'+a.index("section")+'" loop preload="true"><source src="'+a.data("music")+'" type="audio/mpeg"></audio>')}),$("[data-sound]").each(function(){var a=$(this);e.append('<audio id="sound-for-'+a.index("section")+'" preload="true"><source src="'+a.data("sound")+'" type="audio/mpeg"></audio>')}))}function a(e,a,t){$(e).stop().animate({volume:a},1e3,"linear",t)}function t(e){e[0].paused&&(D.each(function(){var e=$(this);a(e,0,function(){e[0].pause()})}),e[0].volume=0,e[0].play(),a(e,q))}function i(e){if(e.hasClass("end")){var a=e.prevAll(".has-intro").first().index("section"),i=$("#music-for-"+a);t(i)}else if(e.hasClass("has-intro")){var n=e.index("section"),s=$("#music-for-"+n);t(s)}else e.is("#home")&&t($("#music-for-0"))}function n(e){var t=e.prevAll(".has-intro").first().index("section"),i=$("#music-for-"+t);a(i[0],0),M.one("before-move.np",function(){ee.hasClass("has-intro")||a(i[0],q)})}function s(e){var t=e.index("section"),i=$("#sound-for-"+t),n=S.not(i);a(S,0,function(){n[0].pause(),n[0].currentTime=0}),i.length>0?(i[0].play(),a(i,q)):S.each(function(){var e=$(this);a(e[0],0,function(){e[0].pause(),e[0].currentTime=0})})}function o(){var e=window.innerHeight;E.css("height",e+"px")}function r(e){var a=e.attr("id"),t=e.attr("style");e.replaceWith('<div id="'+a+'"class="video-substitute" style="'+t+'"></div>')}function d(){H.each(function(){var e=page.width(),a=page.height(),t=$(this).width(),i=$(this).height(),n=e/2-t/2+"px",s=a/2-i/2+"px";$(this).css({left:n,top:s})})}function l(){H.each(function(){$(this)[0].play()})}function c(){function e(){if(!body.hasClass("loaded")){s++;var e=parseInt(s/i*100);n.css("width",e+"%"),o.text(e),s>=i&&body.trigger("load.np")}}var a=$("#preload img"),t=$("#preload audio, .video-background[data-src][data-formats]"),i=isMobile?a.length:a.length+t.length,n=$("#loading-bar"),s=0,o=$("#loading-percentage .number");a.each(function(){$(this).load(e)}),t.each(function(){var a=$(this)[0];a.readyState>3?e():a.oncanplay=e}),page.one("load.np",function(){var e=$("#home-video"),a=$("#music-for-0"),t=$("#home .scroll-message");setTimeout(function(){body.addClass("loaded"),e.addClass("show"),isMobile||a[0].play()},250),setTimeout(function(){body.trigger("start.np")},isDev?0:1e3),setTimeout(function(){t.addClass("show")},2500)}),isDev&&setTimeout(function(){body.trigger("load.np")},500)}function h(){var e=$(window).width();X.each(function(){var a=$(this),t=a.closest(".container").width(),i=e-t;a.css({left:"-"+i/2+"px",right:"-"+i/2+"px"})})}function u(){var e=window.innerWidth,a=window.innerHeight,t=matchMedia("only screen and (max-width: 480px)").matches?a-e/I-5:a,i=t/I;B.css("height",i+"px")}function f(){body.addClass("nav-open").addClass("disable-scroll"),B.each(function(){var e=this,a=$(e).index();setTimeout(function(){$(e).addClass("show")},75*(a+1))}),setTimeout(function(){R.addClass("blur")},250)}function v(){body.removeClass("nav-open").removeClass("disable-scroll"),B.removeClass("show"),setTimeout(function(){R.removeClass("blur")},150)}function m(e,a){for(var t,i=0;i<a.length;i++){var n=a.eq(i);if(e.is(n)){t=i;break}}return t}function p(e){var a,t,i,n=$(e).hasClass("has-intro"),s=$('section[id*="chapter"]'),o=$("#home");if(O.removeClass("active"),n)a=m(e,s),t=$('[href="#'+s.eq(a).attr("id")+'"]',O).parent(),i=a/s.length*100+"%";else if(e.is(o))i=0;else{a=m(e,K);var r=K.eq(a).prevAll(".has-intro").first(),d=(r.attr("id"),m(r,K)),l=m(r,s),c=l/s.length*100,a=m(e,K),h=(a-d)/N[l]/s.length*100;t=$('[href="#'+K.eq(d).attr("id")+'"]',O).parent(),i=c+h+"%"}W.css({width:"",height:""}),matchMedia("only screen and (max-width: 480px)").matches?W.css("width",i):W.css("height",i),t&&t.addClass("active")}function w(e){var a=$(".animate-in",e),t=$(".scroll-message",e);a.each(function(){function e(){0==t||a.is("[data-delay]")||a.attr("data-delay",t+"00")}var a=$(this),t=a.index();$.when(e()).done(function(){var e=a.data("delay")||0;setTimeout(function(){a.addClass("reveal")},e)})}),t.addClass("show")}function g(e,a){switch(a){case"clouds":"undefined"==typeof V?V=e.parallax():V.parallax("enable");break;case"fireworks":"undefined"==typeof Y?Y=e.parallax():Y.parallax("enable")}}function b(e){switch(e){case"clouds":"undefined"!=typeof V&&V.parallax("disable");break;case"fireworks":"undefined"!=typeof Y&&Y.parallax("disable")}}function y(){var e=$("> li",te);te.addClass("show"),e.each(function(){var e=$("img",this),a=$(this).index();setTimeout(function(){e.addClass("show")},100*a)})}function C(){if(ee=$("section.active"),M.trigger("before-move.np"),ee.is("#home")?(re.addClass("show"),le.removeClass("show"),se.removeClass("show"),te.addClass("show"),g(te,"fireworks")):(re.removeClass("show"),se.addClass("show"),le.addClass("show"),te.removeClass("show"),b("fireworks")),ee.hasClass("has-overlay")?ne.addClass("show"):ne.removeClass("show"),ee.hasClass("has-underlay")){var e=ee.data("underlay-background");ae.addClass("show"),g(ae,"clouds"),ce?(ie.addClass("only-fade"),ce=!1):ie.removeClass("only-fade"),ie.css("background-image","url("+e+")").addClass("show")}else ie.removeClass("show"),ae.removeClass("show"),b("clouds");if(ee.hasClass("has-background-underlay")){var a=ee.data("background-image");oe.css("background-image","url("+a+")").addClass("show")}else oe.removeClass("show");ee.is("#home")||ee.hasClass("has-overlay")||ee.hasClass("has-underlay")?de.removeClass("show"):de.addClass("show"),ee.hasClass("end")&&(ce=!0),p(ee),isMobile||(ee.hasClass("no-music")&&n(ee),i(ee),s(ee))}function x(){M.trigger("after-move.np"),w(ee)}function k(){setTimeout(function(){var e;if(matchMedia("only screen and (max-width: 480px)").matches){var a=$(window).width();e=a/I-20}else e=20;he.each(function(){var a=$(this).find(".timeline-content").offset().top,t=$(this).closest("section").offset().top,i=a-t+fe+e,n=$(".timeline-border",this);n.css("top",i+"px")}),ue.each(function(){var e=$(this).find(".timeline-body").last().height(),a=$(this).find(".timeline-content").innerHeight(),t=$(this).closest("section").height()>560?$(this).closest("section").height():560,i=$(this).find(".timeline-gallery").outerHeight(!0),n=$(this).find(".timeline-slider").outerHeight(!0),s=(t-a)/2+e+i+n-fe,o=$(".timeline-border",this);o.css("bottom",s+"px")})},1e3)}function T(){ke.each(function(){var e=$(this),a=$(".quote-image",e),t=e.width(),i=e.height(),n=a.width(),s=a.height(),o=t-n,r=i-s,d=a.data("offset-x")||0,l=a.data("offset-y")||0;a.css({left:o/2+d+"px",top:r/2+l+"px"})})}var M=$("#main");$.when(e()).done(c);var z=$("#audio-icon"),A=$("audio"),D=$('audio[id*="music-for"]'),S=$('audio[id*="sound-for"]'),q=1;isMobile?z.unbind():z.click(function(){$(this).hasClass("fa-volume-up")?($(this).removeClass("fa-volume-up").addClass("fa-volume-off").addClass("adjust-p-r-6"),q=0):($(this).removeClass("fa-volume-off").addClass("fa-volume-up").removeClass("adjust-p-r-6"),q=1),A.each(function(){var e=$(this);e.stop(!1,!0),e.is(S)&&1===q?e[0].volume=0:(e.is(S)&&0===q&&(e[0].pause(),e[0].currentTime=0),e[0].volume=q)})}).parent().addClass("show");var E=$(".full-parent-height");o(),$(window).resize(o);var H=$(".video-background");isMobile?H.each(function(){r($(this))}):H.each(function(){var e=$(this),a=e.data("src"),t="undefined"!=typeof e.data("formats")?e.data("formats").replace(" ","").split(","):"";if(a&&t.length>0)for(var i=0;i<t.length;i++)e.append('<source src="'+a+"."+t[i]+'">');else r(e)}),$(window).resize(d),$(window).load(d),!isMobile&&H.length>0&&$(window).load(l);var X=$(".quote-background-image");h(),$(window).resize($.debounce(500,h));var B=$("nav > ul > li"),F=$("a",B),I=B.length,L=$("#open-nav-button"),P=$("#close-nav-button"),R=$("#underlay, #clouds, #fireworks, .video-background, .video-substitute"),j=$(".main");F.click(function(e){e.preventDefault();var a=$(this).attr("href"),t=$(a).index()+1;v(),j.moveTo(t)}),u(),$(window).resize($.debounce(750,u)),L.click(f),P.click(v);for(var O=$("#sub-nav > ul > li"),U=$("a",O),W=$("#position-indicator"),K=$("section:not(#home)"),N=[],Z=1,_=0;_<K.length;_++){var G=K.eq(_);G.hasClass("end")?(N.push(Z),Z=1):Z++}U.click(function(e){e.preventDefault();var a=$(this).attr("href"),t=$(a).index()+1;j.moveTo(t)}),$(window).resize($.debounce(750,function(){p($("section.active"))}));var J=$(".logo-container.horizontal > a");J.click(function(){j.moveTo(1)});var Q=$("#main section *");Q.on("webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend webkitTransitionStart otransitionstart oTransitionStart msTransitionStart transitionstart",function(e){e.stopPropagation()});var V,Y,ee,ae=$("#clouds"),te=$("#fireworks"),ie=$("#underlay"),ne=$("#overlay"),se=$("#sub-nav"),oe=$("#background-image"),re=$("#home-video"),de=$("#background-video"),le=($("#home #title"),$(".logo-container.horizontal")),ce=!1;body.one("start.np",function(){M.onepage_scroll({sectionContainer:"section",easing:"ease",animationTime:isDev?100:1e3,keyboard:!0,direction:"vertical",pagination:!1,loop:!1,beforeMove:C,afterMove:x}),g(te,"fireworks"),y()});var he=$(".timeline-entry.start"),ue=$(".timeline-entry.end"),fe=30;$(window).load(k),$(window).resize($.debounce(1e3,k));var ve=$(".gallery.type-a"),me=matchMedia("only screen and (max-width: 1024px)").matches?240:80,$e=ve.closest(".container").width();ve.each(function(){function e(){t.unbind().removeClass("active").removeAttr("style"),me=matchMedia("only screen and (max-width: 1024px)").matches?240:80,$e=ve.closest(".container").width(),a.Cloud9Carousel({autoPlay:0,bringToFront:!0,smooth:!0,transforms:!0,speed:250,itemClass:"gallery-entry",yRadius:-25,xRadius:($e-me)/(n-1)}),i.addClass("active"),t.click(function(){t.removeClass("active"),$(this).addClass("active")})}var a=$(this),t=$(".gallery-entry",a),i=t.first(),n=t.length;2===n&&a.addClass("has-two"),a.Cloud9Carousel({autoPlay:0,bringToFront:!0,smooth:!0,transforms:!0,speed:250,itemClass:"gallery-entry",yRadius:-25,xRadius:($e-me)/(n-1)}),i.addClass("active"),t.click(function(){t.removeClass("active"),$(this).addClass("active")}),$(window).resize($.debounce(500,e))});var pe=$(".gallery.type-b");pe.each(function(){function e(){n=matchMedia("only screen and (max-width: 1024px)").matches?60:120,o=$(a).closest(".container").width(),r=matchMedia("only screen and (max-width: 1024px)").matches?240:80,d=o-(i-1)*(n+s)-s-r,$("> li.active",a).css("width",d+"px")}var a=this,t=$("> li",a),i=t.length,n=matchMedia("only screen and (max-width: 1024px)").matches?60:120,s=10,o=$(a).closest(".container").width(),r=matchMedia("only screen and (max-width: 1024px)").matches?240:80,d=o-(i-1)*(n+s)-s-r;t.click(function(){t.removeClass("active").css("width",""),$(this).addClass("active").css("width",d+"px")}),$(window).resize($.debounce(500,e)),t.first().click()});var we=$(".gallery");if(isMobile){var ge=0,be=!1;we.on("touchstart",function(e){e.preventDefault(),ge=e.originalEvent.touches[0].screenX,be=!0}),we.on("touchmove",function(e){be===!0&&($(this).stop(!0,!0).animate({scrollLeft:parseInt($(this).scrollLeft()+1.5*(ge-e.originalEvent.touches[0].screenX))},250),ge=e.originalEvent.touches[0].screenX)}),we.on("touchend touchcancel",function(){be=!1})}else{var ye=0,Ce=!1;we.on("mousedown",function(e){ye=e.offsetX,Ce=!0}),we.on("mousemove",function(e){Ce===!0&&$(this).scrollLeft(parseInt($(this).scrollLeft()+(ye-e.offsetX)))}),we.on("mouseup mouseout",function(){Ce=!1})}var xe=$(".slider");$("section.has-slider");$(window).load(function(){$.when(xe.twentytwenty()).done(function(){setTimeout(function(){xe.each(function(){var e=this,a=$(e).data("before-text")||"Before",t=$(e).data("after-text")||"After",i=$(".twentytwenty-handle",e),n=$(".twentytwenty-before-label, .twentytwenty-after-label",e);n.remove(),i.append('<div class="twentytwenty-before-label">'+a+"</div>",'<div class="twentytwenty-after-label">'+t+"</div>")}),$(this).trigger("resize")},1e3)})});var ke=$(".quote-image-container");$(window).resize($.debounce(500,T)),$(window).load(T)});
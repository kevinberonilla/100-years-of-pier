!function(e){e.fn.CircularCarousel=function(t){function i(e,t,i){var n=0,r=0,a=-i*(Math.PI/180),u=Math.sin(a),l=Math.cos(a),d=v,x=v+1;for(m=[],h.eq(v).addClass("active");g>r;){n+=360/g;var M=n*(Math.PI/180),C=Math.sin(M),z=Math.cos(M),A=e+(f*z*l-c*C*u),T=t+(f*z*u+c*C*l);A=Math.floor(A),T=Math.floor(T),d++,0>d?d=g-1:d===g&&(d=0),x++,0>x?x=g-1:x>=g&&(x=0),h.eq(d).css("margin-top",A+"px"),h.eq(d).css("margin-left",T+"px");var y={top:h.eq(x).offset().top,index:x};m.push(y),r++}var I=h.eq(v),B=h.eq(p);s.trigger("itemBeforeActive",I),s.trigger("itemBeforeDeactivate",B);setTimeout(function(){s.trigger("itemActive",I),s.trigger("itemAfterDeactivate",B)},q);o(v)}function n(e,t,n){var o=0;if(1===t)for(;e>o;){setTimeout(function(){var e=h.eq(v);e.removeClass("active"),p=v,v++,r(),i(u,l,d,null)},o*n);o++}else{o=e;for(var a=0;o>0;){setTimeout(function(){var e=h.eq(v);e.removeClass("active"),p=v,v--,r(),i(u,l,d,null)},a*n);a++,o--}}}function r(){0>v?v=g-1:v>=g&&(v=0)}function o(e){for(var t=m.sort(function(e,t){return e.top-t.top}),i=0;i<t.length;)t[i].index===e&&(h.eq(t[i].index-1).css({"z-index":t.length-1}),h.eq(t[i].index).css({"z-index":t.length-1})),h.eq(t[i].index).css("z-index",i),i++;var n=v+1;0>n?n=g-1:n>=g&&(n=0),h.eq(n).css("z-index",g),h.eq(v).css("z-index",g+1)}function a(e,t,i){for(var n=0,r=0,o=t;o!==i;)r++,o=o===e.length-1?0:o+1;for(o=t;o!==i;)n++,o=0===o?e.length-1:o-1;return n>r?{direction:1,steps:r}:{direction:0,steps:n}}var s=e(this),c=t.ovalWidth,f=t.ovalHeight,v=t.activeItem,u=t.offsetX,l=t.offsetY,d=t.angle,h=s.find("."+t.className),g=h.length,m=[],q=t.duration,p=v;i(u,l,d);var x=(setTimeout(function(){h.addClass("transition");var e=t.duration/1e3+"s";h.css("transition-duration",e)},10),{cycleActive:function(e){var t=h.eq(v);t.removeClass("active"),p=v,v="previous"===e?v-1:v+1,r(),i(u,l,d,null)},cycleActiveTo:function(e){var t=h.eq(v);t.removeClass("active");var o=Math.abs(e-v);if(o>=2){var s=a(h,v,e);n(s.steps,s.direction,q-100)}else p=v,v=e,r(),i(u,l,d,null)},on:function(e,t){s.on(e,t)}});return x}}(jQuery);